<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=next href=license.html><link rel=icon href=img/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.22"><title>ayon-shotgrid</title><link rel=stylesheet href=assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=assets/stylesheets/palette.06af60db.min.css><script src=https://unpkg.com/iframe-worker/shim></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=assets/_mkdocstrings.css><link rel=stylesheet href=css/custom.css><script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#shotgrid-integration-for-ayon class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=index.html title=ayon-shotgrid class="md-header__button md-logo" aria-label=ayon-shotgrid data-md-component=logo> <img src=img/ay-symbol-blackw-full.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ayon-shotgrid </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Home </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ynput/ayon-shotgrid title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=index.html title=ayon-shotgrid class="md-nav__button md-logo" aria-label=ayon-shotgrid data-md-component=logo> <img src=img/ay-symbol-blackw-full.png alt=logo> </a> ayon-shotgrid </label> <div class=md-nav__source> <a href=https://github.com/ynput/ayon-shotgrid title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <a href=index.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Home </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#server class=md-nav__link> <span class=md-ellipsis> Server </span> </a> </li> <li class=md-nav__item> <a href=#desktop-application class=md-nav__link> <span class=md-ellipsis> Desktop application </span> </a> </li> <li class=md-nav__item> <a href=#services class=md-nav__link> <span class=md-ellipsis> Services </span> </a> <nav class=md-nav aria-label=Services> <ul class=md-nav__list> <li class=md-nav__item> <a href=#development class=md-nav__link> <span class=md-ellipsis> Development </span> </a> <nav class=md-nav aria-label=Development> <ul class=md-nav__list> <li class=md-nav__item> <a href=#building-docker-images class=md-nav__link> <span class=md-ellipsis> Building Docker Images </span> </a> </li> <li class=md-nav__item> <a href=#running-the-service-locally class=md-nav__link> <span class=md-ellipsis> Running the Service locally </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#makefile-commands class=md-nav__link> <span class=md-ellipsis> Makefile commands </span> </a> </li> <li class=md-nav__item> <a href=#running-it-without-docker-or-make class=md-nav__link> <span class=md-ellipsis> Running it without docker or make </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=license.html class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=autoapi/client/ayon_shotgrid/addon.html class=md-nav__link> <span class=md-ellipsis> client </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=autoapi/server/settings/main.html class=md-nav__link> <span class=md-ellipsis> server </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=autoapi/service_tools/main.html class=md-nav__link> <span class=md-ellipsis> service_tools </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=autoapi/services/leecher/leecher/__main__.html class=md-nav__link> <span class=md-ellipsis> services </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#server class=md-nav__link> <span class=md-ellipsis> Server </span> </a> </li> <li class=md-nav__item> <a href=#desktop-application class=md-nav__link> <span class=md-ellipsis> Desktop application </span> </a> </li> <li class=md-nav__item> <a href=#services class=md-nav__link> <span class=md-ellipsis> Services </span> </a> <nav class=md-nav aria-label=Services> <ul class=md-nav__list> <li class=md-nav__item> <a href=#development class=md-nav__link> <span class=md-ellipsis> Development </span> </a> <nav class=md-nav aria-label=Development> <ul class=md-nav__list> <li class=md-nav__item> <a href=#building-docker-images class=md-nav__link> <span class=md-ellipsis> Building Docker Images </span> </a> </li> <li class=md-nav__item> <a href=#running-the-service-locally class=md-nav__link> <span class=md-ellipsis> Running the Service locally </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#makefile-commands class=md-nav__link> <span class=md-ellipsis> Makefile commands </span> </a> </li> <li class=md-nav__item> <a href=#running-it-without-docker-or-make class=md-nav__link> <span class=md-ellipsis> Running it without docker or make </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=shotgrid-integration-for-ayon>Shotgrid integration for AYON</h1> <p>This project provides three elements for the AYON pipeline:</p> <ul> <li>server/ - The AYON Backend Addon.</li> <li>frontend/ - The AYON server Shotgrid settings tab.</li> <li>client/ - The AYON desktop integration.</li> <li>services/ - Standalone dockerized daemons that act based on events (aka <code>leecher</code> and <code>processors</code>).</li> </ul> <p>In order to use this integration, you'll need to run the <code>python create_package.py</code> script, which will create a <code>zip</code> file with the current version (the number is defined in <code>package.py</code>) in <code>ayon-shotgrid/package/shotgrid-{addon version}.zip</code>. You can then upload this zip file in your AYON instance, on the Bundles (<code>/settings/bundles</code>) section. Make sure you restart the server. AYON should prompt you to do so after uploading.</p> <h2 id=server>Server</h2> <p>Once the instance has restarted, you should be able to enable the addon by going into the <code>Settings &gt; Bundles</code> and creating (or duplicating an existing) bundle, where you can now choose <code>shotgrid</code> and the <code>version</code> you installed. Make sure you set the bundle as <code>Production</code>. If the addon loaded successfully, you should be able to see a new tab in your <code>Settings &gt; Shotgrid</code>.</p> <p>For the Shotgrid integration to work, we need to provide several pieces of information. Firstly, weâ€™ll need a Shotgrid Script and its API key. Refer to the <a href="https://developer.shotgridsoftware.com/99105475/?title=Create+and+manage+API+scripts">Shotgrid Documentation</a> to create one; take note of the information and in AYON, navigate to the <code>Settings &gt; Secrets</code> page. Create a new secret with the <code>script_name</code> as the "Secret Name" and the <code>script_api_key</code> as the "Secret Value".</p> <p>We can now go into the <code>Settings &gt; Studio settings &gt; Shotgrid</code> page in AYON and fill in the following fields: * Shotgrid URL - This will be the URL to your Shotgrid instance. * Shotgrid API Secret - Select the secret you created in the previous step. * Shotgrid field for the Project Code - A field in the <code>Project</code> entity that holds the project code. It can be an existing one or a new one. The default is <code>code</code>. * Service Settings &gt; How often (in seconds) to query the Shotgrid Database - Defaults to 10 seconds, the time between <code>leeching</code>, <code>processing</code>, and <code>transmitting</code> operations.</p> <h2 id=desktop-application>Desktop application</h2> <p>When launching AYON for the first time, you'll be asked to provide a login (only the username) for Shotgrid. This is the user that will be used for publishing. After providing a login, people can publish normally. The integration will ensure that the user can connect to Shotgrid, has the correct permissions, and will create the Version and PublishedFile in Shotgrid if the publish is successful.</p> <h2 id=services>Services</h2> <p>The services are a way to handle operations between AYON and Shotgrid in the background. These have been developed around the AYON Events system. We replicate Shotgrid events (the ones we care about) as AYON <code>shotgrid.event</code>, which then the <code>processor</code> will pick up and process them accordingly. Lastly, the <code>transmitter</code> will look for changes in AYON and attempt to replicate them in Shotgrid. In any case, the Shotgrid project has to have the field "Ayon Auto Sync" enabled for the <code>leecher</code> and the <code>transmitter</code> to work. They share code, which is found in <code>shotgrid_common</code>. Most importantly, the <code>AyonShotgridHub</code> is a class that bootstraps common actions when working with AYON and Shotgrid.</p> <p>The three provided services are:</p> <ul> <li><code>processor</code> - This has a set of handlers for different <code>shotgrid.event</code> and acts on them.</li> <li><code>leecher</code> - Periodically queries the <code>EventLogEntry</code> table on Shotgrid and ingests any event that interests us, dispatching it as a <code>shotgrid.event</code>. This will only query projects that have the "Ayon Auto Sync" field enabled.</li> <li><code>transmitter</code> - Periodically checks for new events in AYON of topic <code>entity.*</code> and pushes any changes to Shotgrid, only affecting projects that have the "Ayon Auto Sync" field enabled.</li> </ul> <p>The most straightforward way to get this up and running is by using ASH (AYON Service Host). After loading the Addon on the server, you should be able to spawn services in the "Services" page.</p> <h3 id=development>Development</h3> <p>There's a single <code>Makefile</code> at the root of the <code>services</code> folder, which is used to <code>build</code> the Docker images and to run the services locally with the <code>dev</code> target. This is UNIX only for the time being. Running <code>make</code> without arguments will print information as to how to run and use it.</p> <h4 id=building-docker-images>Building Docker Images</h4> <p>To build the Docker images, you can run <code>make SERVICE=&lt;service-name&gt; build</code>. So, for example, to build the <code>processor</code>, you'd do <code>make SERVICE=processor build</code>. This will build and tag the local image, with the version found in <code>package.py</code> at the root of the addon.</p> <h4 id=running-the-service-locally>Running the Service locally</h4> <p>In order to run the service locally, we need to specify certain environment variables. To do so, copy the <code>sample_env</code> file, rename it to <code>.env</code>, and fill the fields accordingly:</p> <pre><code>AYON_API_KEY=&lt;AYON_API_KEY&gt; # You can create a `service` user in AYON, and then get the Key from there.
AYON_SERVER_URL=&lt;YOUR_AYON_URL&gt;
PYTHONDONTWRITEBYTECODE=1
</code></pre> <p>We are ready to spin up the service. For convenience, we got a <code>make</code> target for this:</p> <pre><code class=language-sh>make SERVICE=&lt;service-name&gt; dev
</code></pre> <p>You should now see something similar to:</p> <pre><code class=language-sh>INFO       Initializing the Shotgrid Processor.
DEBUG      Found these handlers: {'create-project': [&lt;module 'project_sync'&gt;], 'sync-from-shotgrid': [&lt;module 'sync_from_shotgrid'&gt;], 'shotgrid-event': [&lt;module 'update_from_shotgrid'&gt;]}
INFO       Start enrolling for AYON `shotgrid.event` Events...
INFO       Querying for new `shotgrid.event` events...
INFO       No event of origin `shotgrid.event` is pending.
</code></pre> <h3 id=makefile-commands>Makefile commands</h3> <p>For those who cannot use <code>Makefiles</code>, here are the commands that are required to perform the same action as with <code>make</code>, using the <code>processor</code> version <code>0.2.</code> as an example, from the <code>services</code> folder:</p> <p>Building the Docker image:</p> <p>```sh docker build -t ynput/ayon-shotgrid-processor:0.2.1 -f processor/Dockerfile .</p> <pre><code>
Running a service locally:

```sh
docker run --rm -u ayonuser -ti \
  -v services/shotgrid_common:services/shotgrid_common:Z \
  -v services/processor:/service:Z \
  --env-file services/processor/.env \
  --env AYON_ADDON_NAME=shotgrid \
  --env AYON_ADDON_VERSION=0.2.1 \
  --attach=stdin \
  --attach=stdout \
  --attach=stderr \
  --network=host \
  ynput/ayon-shotgrid-processor:0.2.1 python -m processor
</code></pre> <p>This one is trickier since the Makefile will symlink the <code>shotgrid_common</code> inside the <code>service/processor</code> folder.</p> <h3 id=running-it-without-docker-or-make>Running it without docker or make</h3> <p>You don't need to run these as Dockerized scripts; for that, you'll need either <a href=https://python-poetry.org/ >Poetry</a> installed and create an environment specified by the <code>pyproject.toml</code> or using <code>virtualenv</code> and install the packages specified in the <code>[tool.poetry.dependencies]</code> section of the <code>pyproject.toml</code>; once in that environment, you'll need to load the contents of the <code>.env</code> file and finally:</p> <pre><code class=language-sh>python -m processor
</code></pre> <h1 id=usage>Usage</h1> <p>With this integration, you can perform the following actions by navigating to <code>AYON &gt;Settings &gt; Shotgrid</code> and loading all projects by clicking <code>Populate Data</code>:</p> <h2 id=import-a-new-shotgrid-project>Import a New Shotgrid Project</h2> <p>With the <code>processor</code> service running, synchronize <code>Shotgrid --&gt; AYON</code> will replicate the Shotgrid structure in AYON.</p> <h2 id=export-an-ayon-project-into-shotgrid>Export an AYON project into Shotgrid</h2> <p>With the <code>processor</code> service running, synchronize <code>AYON --&gt; Shotgrid</code> will replicate the AYON structure in Shotgrid.</p> <h2 id=update-based-on-shotgrid-events>Update based on Shotgrid Events</h2> <p>With the <code>leecher</code> <strong>and</strong> the <code>processor</code> services running, and the <code>Ayon Auto Sync</code> field <strong>enabled</strong> in Shotgrid, whenever an event on <code>Episodes</code>, <code>Sequences</code>, <code>Shots</code>, or <code>Tasks</code> occurs, an event will be dispatched in Ayon <code>shotgrid.event</code>; this event will be then processed in another event <code>shotgrid.proc</code> dispatched by the <code>processor</code> service; this currently creates and removes entities and updates the name of entities so they are in sync between Shotgrid and Ayon.</p> <h2 id=update-based-on-ayon-events>Update based on AYON Events</h2> <p>With the <code>transmitter</code> <strong>and</strong> the <code>processor</code> services running, and the <code>Ayon Auto Sync</code> field <strong>enabled</strong> in Shotgrid, whenever an event on <code>entity.*</code> occurs in AYON, an event will be dispatched in Ayon <code>shotgrid.push</code>; this event will attempt to replicate the changes made in AYON in Shotgrid.</p> <p>In all instances, you'll want to keep an eye on the terminal where you launched the services, where you can track the progress of any of the handlers. This will be improved in the future so it can be tracked from AYON.</p> <h1 id=automated-tests>Automated tests</h1> <p>These tests do not yet cover all use cases and features provided by the sync services. Instead, they act as a safety net to proactively catch regressions on core functionalities.</p> <p>We strongly recommend running them locally with each new contribution. They require a local AYON server but no FLOW instance, thanks to <a href=https://github.com/shotgunsoftware/python-api/blob/master/shotgun_api3/lib/mockgun/mockgun.py>Mockgun</a>, which simulates a FLOW environment entirely in memory.</p> <h2 id=requirements>Requirements</h2> <ul> <li>Your local <code>python</code> should be &gt;=3.10</li> <li>You need a local AYON server with a service AYON_API_KEY defined</li> </ul> <h2 id=run-the-tests>Run the tests</h2> <p>Windows:</p> <pre><code class=language-shell>.\service_tools\manage.ps1 run-tests
</code></pre> <p>Linux:</p> <pre><code>./service_tools/make runtests
</code></pre> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": ".", "features": ["navigation.sections", "navigation.path", "navigation.prune"], "search": "assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=assets/javascripts/bundle.f55a23d4.min.js></script> </body> </html>